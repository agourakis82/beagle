# Cluster Deep Audit Report

**Gerado em:** 2025-11-18 20:22:40

---

## Resumo Executivo

Este relat√≥rio cont√©m auditoria completa de todos os nodes do cluster:
- **tower** (windows_wsl) - IP: 100.109.113.80
- **maria** (linux) - IP: 100.114.199.67

---

## Node: tower (windows_wsl)

### Sistema
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### CPU
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Mem√≥ria
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### GPU
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Filesystems
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Top 20 Maiores Diret√≥rios
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Arquivos Grandes (>1GB)
**Total encontrado:** 1
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Docker Containers
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Docker Disk Usage
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Top Processos (por Mem√≥ria)
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### RDMA/InfiniBand Status
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Windows - Drive C Diagn√≥stico

#### Volumes
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

#### Top Diret√≥rios em C:\
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

#### WindowsApps
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

#### Program Files
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

#### Users
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

#### Temp Files
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

#### Docker Data Root
```
ERROR: Failed to execute PowerShell on tower (timeout or error)
```

---

## Node: maria (linux)

### Sistema
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### CPU
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Mem√≥ria
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### GPU
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Filesystems
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Top 20 Maiores Diret√≥rios
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Arquivos Grandes (>1GB)
**Total encontrado:** 1
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Docker Containers
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Docker Disk Usage
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### Top Processos (por Mem√≥ria)
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

### RDMA/InfiniBand Status
```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

---

## An√°lise e Recomenda√ß√µes

### Diagn√≥stico Drive C (Tower)

=== DIAGN√ìSTICO DRIVE C (TOWER) ===

VOLUMES DISPON√çVEIS:

ERROR: Failed to execute PowerShell on tower (timeout or error)

TOP 20 DIRET√ìRIOS EM C:\:

   ERROR: Failed to execute PowerShell on tower (timeout or error)

WINDOWSAPPS:
ERROR: Failed to execute PowerShell on tower (timeout or error)
‚ÑπÔ∏è  WindowsApps geralmente n√£o pode ser removido, mas pode ser otimizado removendo apps n√£o usados

PROGRAM FILES:
ERROR: Failed to execute PowerShell on tower (timeout or error)

USERS (por tamanho):
ERROR: Failed to execute PowerShell on tower (timeout or error)

TEMP FILES (RECUPER√ÅVEL):
ERROR: Failed to execute PowerShell on tower (timeout or error)

üí∞ Espa√ßo total em temp files: ~
0 GB (RECUPER√ÅVEL)

DOCKER DATA ROOT:
ERROR: Failed to execute PowerShell on tower (timeout or error)

---

üí∞ ESPA√áO RECUPER√ÅVEL ESTIMADO:
   Total: ~0 GB

Breakdown:
   - Temp files: ~
0 GB
   - Docker data (mover): ~0 GB
   - Outros (avaliar): Ver diret√≥rios acima


### An√°lise de Storage: tower

=== AN√ÅLISE DE STORAGE ===

FILESYSTEMS (Uso > 70% destacado):


TOP 10 MAIORES DIRET√ìRIOS:

N/A:       ‚îÇ                                                  ‚îÇ Node

ARQUIVOS > 1GB: 1 encontrados
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel

DOCKER DISK USAGE:
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel

PROBLEMAS IDENTIFICADOS:

‚ö†Ô∏è  node_modules encontrado (pode ser limpo): N/A: total
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel


### An√°lise de Storage: maria

=== AN√ÅLISE DE STORAGE ===

FILESYSTEMS (Uso > 70% destacado):


TOP 10 MAIORES DIRET√ìRIOS:

N/A:       ‚îÇ                                                  ‚îÇ Node

ARQUIVOS > 1GB: 1 encontrados
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel

DOCKER DISK USAGE:
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel

PROBLEMAS IDENTIFICADOS:

‚ö†Ô∏è  node_modules encontrado (pode ser limpo): N/A: total
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel


### Comandos de Limpeza Segura (Tower)

=== COMANDOS DE LIMPEZA SEGURA (TOWER) ===

‚ö†Ô∏è  IMPORTANTE: Execute com cuidado. Fa√ßa backup antes!

üí∞ Espa√ßo total estimado recuper√°vel: ~0 GB

## COMANDO 1: Limpar temp files do Windows (pode liberar 10-50GB+)

```powershell
# Execute no PowerShell como Administrador
$tempDirs = @('C:\Windows\Temp', 'C:\Temp', $env:TEMP);
$totalFreed = 0;
foreach ($dir in $tempDirs) {
    if (Test-Path $dir) {
        $sizeBefore = (Get-ChildItem $dir -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum;
        Get-ChildItem $dir -Recurse -File -ErrorAction SilentlyContinue | Remove-Item -Force -ErrorAction SilentlyContinue;
        Get-ChildItem $dir -Recurse -Directory -ErrorAction SilentlyContinue | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue;
        $sizeAfter = (Get-ChildItem $dir -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum;
        $freed = [math]::Round(($sizeBefore - $sizeAfter)/1GB, 2);
        Write-Host "Liberado de $dir : $freed GB";
        $totalFreed += $freed;
    }
}
Write-Host "Total liberado: $([math]::Round($totalFreed, 2)) GB"
```

## COMANDO 2: Mover Docker data root para outro drive (ex: D:\) (pode liberar 20-100GB+)

‚ö†Ô∏è  Este comando move Docker data. Certifique-se de que:
   1. Todos os containers est√£o parados
   2. Voc√™ tem espa√ßo no drive de destino
   3. Voc√™ fez backup dos volumes importantes

**Passo 1: Parar containers**
```bash
# Execute no WSL
wsl.exe -e docker stop $(wsl.exe -e docker ps -q)
wsl.exe -e docker system prune -a --volumes -f  # Limpa imagens n√£o usadas (opcional)
```

**Passo 2: Mover Docker data**
```powershell
# Execute no PowerShell como Administrador
$oldPath = $env:ProgramData + '\Docker';
$newPath = 'D:\Docker';  # Ajuste para o drive desejado

if (Test-Path $oldPath) {
    # Cria diret√≥rio destino
    New-Item -ItemType Directory -Path $newPath -Force | Out-Null;
    
    # Move dados (robocopy preserva permiss√µes)
    robocopy $oldPath $newPath /MIR /R:3 /W:5 /NP /NDL /NFL;
    
    # VERIFICA antes de deletar o antigo!
    Write-Host 'Verifique se todos os arquivos foram copiados antes de continuar';
    Write-Host 'Para deletar o antigo: Remove-Item $oldPath -Recurse -Force';
    
    # Ap√≥s mover, configure Docker para usar novo path (requer reiniciar Docker/WSL)
} else {
    Write-Host 'Docker data root n√£o encontrado em $oldPath';
}
```

## COMANDO 3: Limpar cache do Windows Update (pode liberar 5-30GB+)

```powershell
# Execute no PowerShell como Administrador
Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue;
Stop-Service -Name cryptSvc -Force -ErrorAction SilentlyContinue;
Stop-Service -Name bits -Force -ErrorAction SilentlyContinue;
Stop-Service -Name msiserver -Force -ErrorAction SilentlyContinue;

$updateCachePath = 'C:\Windows\SoftwareDistribution\Download';
if (Test-Path $updateCachePath) {
    $sizeBefore = (Get-ChildItem $updateCachePath -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum;
    Remove-Item $updateCachePath -Recurse -Force -ErrorAction SilentlyContinue;
    Write-Host "Cache do Windows Update limpo: $([math]::Round($sizeBefore/1GB, 2)) GB liberados";
} else {
    Write-Host 'Cache do Windows Update n√£o encontrado';
}

Start-Service -Name wuauserv -ErrorAction SilentlyContinue;
Start-Service -Name cryptSvc -ErrorAction SilentlyContinue;
Start-Service -Name bits -ErrorAction SilentlyContinue;
Start-Service -Name msiserver -ErrorAction SilentlyContinue;
```

## COMANDO 4 (BONUS): Limpar logs antigos do Windows (pode liberar 1-10GB+)

```powershell
# Execute no PowerShell como Administrador
$logsPath = 'C:\Windows\Logs';
if (Test-Path $logsPath) {
    $oldLogs = Get-ChildItem $logsPath -Recurse -File | Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-30) };
    $sizeBefore = ($oldLogs | Measure-Object -Property Length -Sum).Sum;
    $oldLogs | Remove-Item -Force -ErrorAction SilentlyContinue;
    Write-Host "Logs antigos removidos: $([math]::Round($sizeBefore/1GB, 2)) GB";
    
    # Limpa event logs antigos
    wevtutil el | ForEach-Object { wevtutil cl "$_" /f 2>&1 | Out-Null };
    Write-Host 'Event logs limpos';
}
```

## COMANDO 5 (BONUS): Limpar WSL distros n√£o usadas

```bash
# Lista distros WSL
wsl.exe --list --verbose

# Para remover uma distro (substitua <DistroName>):
# wsl.exe --unregister <DistroName>

# Exemplo: remover Ubuntu se n√£o estiver usando
# wsl.exe --unregister Ubuntu
```

---

## Ordem Recomendada de Execu√ß√£o:

1. **COMANDO 1** (temp files) - Mais seguro, pode liberar 10-50GB
2. **COMANDO 3** (Windows Update) - Seguro, pode liberar 5-30GB
3. **COMANDO 4** (logs antigos) - Seguro, pode liberar 1-10GB
4. **COMANDO 2** (Docker data) - Requer cuidado, pode liberar 20-100GB
5. **COMANDO 5** (WSL distros) - Avaliar caso a caso

**Total estimado recuper√°vel: 0 GB+**


### Resumo Geral do Cluster

#### Nodes Auditados

- **tower** (windows_wsl)
  - IP Tailscale: 100.109.113.80
  - IP RDMA: 10.100.0.2

- **maria** (linux)
  - IP Tailscale: 100.114.199.67
  - IP RDMA: 10.100.0.1

#### Gargalos Identificados

#### Espa√ßo Recuper√°vel Estimado (Tower)

- **Total estimado: ~0 GB**

Breakdown:
  - Temp files: ~
0 GB
  - Windows Update cache: ~5-30 GB
  - Logs antigos: ~1-10 GB

#### RDMA 100Gbps Status

- **tower**: ‚úÖ RDMA detectado
  - Dispositivos:
    N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel

- **maria**: ‚úÖ RDMA detectado
  - Dispositivos:
    N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel

**Teste de Performance RDMA:**

```
N/A: Node n√£o acess√≠vel ou comando n√£o dispon√≠vel
```

#### Recomenda√ß√µes Imediatas

**Para Tower (Drive C lotado):**

1. Execute COMANDO 1 (limpar temp files) - Mais seguro, ~10-50GB
2. Execute COMANDO 3 (limpar Windows Update) - Seguro, ~5-30GB
3. Avalie COMANDO 2 (mover Docker data) - Requer cuidado, ~20-100GB

---

**Fim do Relat√≥rio**

*Dados tempor√°rios salvos em: /tmp/cluster_audit_si4cnG*
*Execute 'rm -rf /tmp/cluster_audit_si4cnG' para limpar ap√≥s revisar o relat√≥rio*
